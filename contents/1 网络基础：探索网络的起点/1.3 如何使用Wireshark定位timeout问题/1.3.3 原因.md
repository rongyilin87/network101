# 案例分析：常见超时根因如何识别

利用抓包后的时间线，我们可以把超时问题归纳成几类常见模式。以下示例可以帮助你快速比对自身的抓包结果。

## 模式一：握手阶段丢包
**表现**：客户端发送多次 SYN，但没有收到任何回应，最终触发 TCP 超时重传。

**抓包特征**：
- 多个 SYN 报文间隔大约 1、3、7 秒（遵循指数退避）；
- 抓不到任何来自服务器的报文；
- 可能伴随 `ARP Request` 没有 `Reply`。

**可能原因**：服务器不可达、ACL 拦截、SYN 被 DDoS 防御设备丢弃、SYN Cookie 配置异常。

## 模式二：TLS 握手停滞
**表现**：三次握手正常，但 TLS ClientHello 之后迟迟没有 ServerHello。

**抓包特征**：
- 客户端不断重传 ClientHello；
- 服务器偶尔回应 `RST`，或完全无响应；
- Wireshark I/O 图表显示在某个时间点之后吞吐量下降为零。

**可能原因**：
- 服务器 TLS 证书或配置问题导致握手失败；
- 负载均衡后端健康检查异常，把流量转发到宕机节点；
- 中间代理对 TLS 握手进行了深度检测并阻断。

## 模式三：应用处理过慢
**表现**：请求成功到达服务器，但响应非常迟缓，超过客户端等待时间。

**抓包特征**：
- TCP 流中可以看到完整的 HTTP 请求（甚至带有数据体）；
- 长时间没有返回报文，期间客户端可能发送 `ACK` 保持连接；
- 最终客户端发送 `RST` 断开连接。

**可能原因**：数据库慢查询、线程池耗尽、外部依赖服务不可用、服务器过载。

## 模式四：中途丢包导致重传
**表现**：请求和响应都有，但是存在大量重传，导致整体延迟上升并触发超时。

**抓包特征**：
- `tcp.analysis.retransmission` 过滤器命中多次；
- 有时伴随 `Duplicate ACK`，提示某个序列号一直未收到；
- RTT 图呈锯齿状波动。

**可能原因**：链路质量差（Wi-Fi 干扰、跨国线路）、网络拥塞、MTU 设置不一致导致分片失败。

通过对照这些模式，你可以把 Wireshark 抓到的“症状”与可能的根因一一对应，再结合业务日志和监控指标，最终锁定超时的真正原因。
